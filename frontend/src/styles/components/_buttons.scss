@mixin btn-vars(
  $tone,
  $light-text: null,
  $light-bg-mix: 84%,
  $light-border-mix: 66%
) {
  $bg: rgba(mix(rgba($white, 0.92), mix($white, $tone, $light-bg-mix), 68%), 0.95);
  $border: mix($white, $tone, $light-border-mix - 4%);
  $fg: if($light-text != null, $light-text, mix($tone, $black, 90%));
  $hover-bg: rgba(mix(rgba($white, 0.96), mix($white, $tone, $light-bg-mix - 8%), 62%), 0.98);
  $hover-border: mix($white, $tone, $light-border-mix - 16%);
  $hover-fg: mix($fg, $black, 88%);
  $active-bg: rgba(mix($white, $tone, 52%), 1);
  $active-border: mix($tone, $black, 86%);
  $active-fg: mix($fg, $black, 92%);

  --btn-chip-bg: #{$bg};
  --btn-chip-border: #{$border};
  --btn-chip-fg: #{$fg};
  --btn-chip-hover-bg: #{$hover-bg};
  --btn-chip-hover-border: #{$hover-border};
  --btn-chip-hover-fg: #{$hover-fg};
  --btn-chip-active-bg: #{$active-bg};
  --btn-chip-active-border: #{$active-border};
  --btn-chip-active-fg: #{$active-fg};
}

@mixin btn-dark-vars($bg, $border, $fg) {
  --btn-chip-bg: #{$bg};
  --btn-chip-border: #{$border};
  --btn-chip-fg: #{$fg};
  --btn-chip-hover-bg: #{mix($bg, $border, 74%)};
  --btn-chip-hover-border: #{opacify($border, 0.12)};
  --btn-chip-hover-fg: #{mix($fg, $white, 82%)};
  --btn-chip-active-bg: #{mix($bg, $border, 58%)};
  --btn-chip-active-border: #{opacify($border, 0.2)};
  --btn-chip-active-fg: #{mix($fg, $white, 90%)};
}

@mixin btn-variant(
  $selector,
  $tone,
  $light-text: null,
  $light-bg-mix: 84%,
  $light-border-mix: 66%
) {
  .btn.#{$selector} {
    @include btn-vars($tone, $light-text, $light-bg-mix, $light-border-mix);
  }
}

@mixin btn-dark-variant($selector, $bg, $border, $fg) {
  body.theme-dark .btn.#{$selector} {
    @include btn-dark-vars($bg, $border, $fg);
  }
}

.btn {
  transition: background-color .2s ease, border-color .2s ease, color .2s ease;
  box-shadow: none !important;
}

.btn.btn-primary,
.btn.btn-secondary,
.btn.btn-success,
.btn.btn-danger,
.btn.btn-warning,
.btn.btn-info {
  border-color: var(--btn-chip-border) !important;
  background-color: var(--btn-chip-bg) !important;
  color: var(--btn-chip-fg) !important;

  &:hover:not(:disabled) {
    border-color: var(--btn-chip-hover-border) !important;
    background-color: var(--btn-chip-hover-bg) !important;
    color: var(--btn-chip-hover-fg) !important;
  }

  &:is(.active, :active):not(:disabled) {
    border-color: var(--btn-chip-active-border) !important;
    background-color: var(--btn-chip-active-bg) !important;
    color: var(--btn-chip-active-fg) !important;
  }

  &:disabled {
    border-color: var(--btn-chip-border) !important;
    background-color: var(--btn-chip-bg) !important;
    color: var(--btn-chip-fg) !important;
  }
}

.btn-check:checked + .btn.btn-primary,
.btn-check:active + .btn.btn-primary,
.btn-check:checked + .btn.btn-secondary,
.btn-check:active + .btn.btn-secondary,
.btn-check:checked + .btn.btn-success,
.btn-check:active + .btn.btn-success,
.btn-check:checked + .btn.btn-danger,
.btn-check:active + .btn.btn-danger,
.btn-check:checked + .btn.btn-warning,
.btn-check:active + .btn.btn-warning,
.btn-check:checked + .btn.btn-info,
.btn-check:active + .btn.btn-info {
  border-color: var(--btn-chip-active-border) !important;
  background-color: var(--btn-chip-active-bg) !important;
  color: var(--btn-chip-active-fg) !important;
}

.btn-link {
  box-shadow: none !important;
}

.btn-custom {
  @extend .btn-secondary;
  margin-right: 0.2rem;
  transition: background-color .2s ease, border-color .2s ease, color .2s ease;
}

.btn-default {
  @extend .btn;
}

.btn-xs {
  @include button-size($btn-padding-y-xs, $btn-padding-x-xs, $font-size-2xs, $btn-border-radius-sm);
}

.btn-xxs {
  @include button-size($btn-padding-y-xs, $btn-padding-x-xs, $font-size-3xs, $btn-border-radius-sm);
}

.btn-outline-secondary-alt {
  @extend .btn-outline-secondary;
}

.btn-file-upload {
  position: relative;
  overflow: hidden;
  cursor: pointer;

  input {
    position: absolute;
    top: 0;
    right: 0;
    margin: 0;
    padding: 0;
    opacity: 0;
  }
}


.btn-minimize {
  @extend .btn-close;
}

.btn-minimize-white {
  @extend .btn-close-white;
}

$button-variants: (
  'btn-primary': (tone: 'primary', text: semantic-ink('primary', 88%), bg-mix: 70%, border-mix: 48%),
  'btn-secondary': (tone: 'secondary', text: semantic-ink('gray-dark', 94%), bg-mix: 62%, border-mix: 34%),
  'btn-success': (tone: 'success', text: semantic-ink('success', 90%), bg-mix: 68%, border-mix: 46%),
  'btn-danger': (tone: 'danger'),
  'btn-warning': (tone: 'warning', text: #a35400, bg-mix: 54%, border-mix: 34%),
  'btn-info': (tone: 'info-btn', text: semantic-ink('gray-dark', 90%), bg-mix: 68%, border-mix: 48%)
);

$button-dark-variants: (
  'btn-primary': 'primary',
  'btn-secondary': 'secondary',
  'btn-success': 'success',
  'btn-danger': 'danger',
  'btn-warning': 'warning',
  'btn-info': 'btn-info'
);

@each $selector, $config in $button-variants {
  $bg-mix: map-get($config, bg-mix);
  $border-mix: map-get($config, border-mix);

  @include btn-variant(
    $selector,
    semantic-tone(map-get($config, tone)),
    map-get($config, text),
    if($bg-mix == null, 84%, $bg-mix),
    if($border-mix == null, 66%, $border-mix)
  );
}

@each $selector, $dark-key in $button-dark-variants {
  @include btn-dark-variant(
    $selector,
    semantic-dark($dark-key, bg),
    semantic-dark($dark-key, border),
    semantic-dark($dark-key, fg)
  );
}
