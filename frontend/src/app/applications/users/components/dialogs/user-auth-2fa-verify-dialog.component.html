<!--
  ~ Copyright (C) 2012-2025 Johan Legrand <johan.legrand@sync-in.com>
  ~ This file is part of Sync-in | The open source file sync and share solution
  ~ See the LICENSE file for licensing details
  -->
<div class="modal-header align-items-center justify-content-center">
  <h4 class="modal-title">
    <fa-icon [icon]="icons.faLock" class="me-2"></fa-icon>
    <span l10nTranslate>Two-Factor Authentication</span>
  </h4>
</div>
<div class="modal-body modal-auth-verify-2fa">
  <div class="card shadow-sm">
    <div class="card-body">
      @if (hasError) {
        <p class="text-danger d-flex justify-content-center align-items-center mb-3" style="height: 36px" l10nTranslate>{{ hasError }}</p>
      } @else {
        <p class="text-muted d-flex justify-content-center align-items-center mb-3" style="height: 36px" l10nTranslate>
          @if (withPassword) {
            Enter your password
          } @else {
            Valid with your TOTP code
          }
        </p>
      }
      <form (ngSubmit)="onSubmit()" [formGroup]="twoFaForm">
        @if (withPassword) {
          <div class="mb-4">
            <app-input-password id="password"
                                [password]="twoFaForm.value.password"
                                (passwordChange)="twoFaForm.controls.password.setValue($event)"
                                [focus]="true"
                                [centered]="true"
                                placeholder="••••••">
            </app-input-password>
          </div>
          <div class="text-muted text-align-center mb-3" l10nTranslate>Valid with your TOTP code</div>
        }
        <div class="mb-3">
          <input
            appAutofocus
            type="text"
            [maxlength]=twoFaCodelength
            class="form-control text-center fs-4"
            formControlName="totpCode"
            placeholder="••••••"
            inputmode="numeric"
            autocomplete="one-time-code"
            name="totp"
          />
        </div>
        <div class="d-grid gap-2">
          <button type="submit" [disabled]="twoFaForm.invalid || submitted" class="btn btn-primary" l10nTranslate>Confirm</button>
          <button type="button" (click)="onClose()" class="btn btn-secondary" l10nTranslate>Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>

